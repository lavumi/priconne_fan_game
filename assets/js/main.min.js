let ScreenSize=[1024,768];function GameMain(){let o=Date.now()/1e3,s=[0,0,0,1],r,S=[[500,500],[100,250,100,250,500],[100,500],[300,500,300,500],[250,500]],a=[500,500],l=1,c=[],d=[[],[],[],[],[],[],[],[]],m=[4,700/256],u=0,g=3,y=50,h=400,E={GAME_LOBBY:0,GAME_ENTRY:1,GAME_COUNTDOWN:2,GAME_START:3,GAME_OVER:5,HIGH_SCORE:6,GAME_RESTART:7};let M=null,n={};function p(e){let t=0;for(let e=0;e<c.length;e++)t<c[e][0]&&(t=c[e][0]);let n;var i;n=(1===a.length&&(i=Math.floor(4*Math.random()),a=a.concat(S[i])),a.shift()),c[e][0]=t+n}function i(){r.setDearIdle(),requestAnimationFrame(A),r.setPosition(0),u=0,g=3,M=E.GAME_LOBBY,c.length=0,d=[[],[],[],[],[],[],[],[]];for(let t=0;t<3;t++)for(let e=0;e<d.length;e++)d[e].push([1024*t-512,-315]);for(let e=0;e<10;e++)c.push([512*e+1024,-314]);FontSystem.setVisible("score",!0),FontSystem.setVisible("CountDown",!1),FontSystem.setVisible("Ranktxt",!1),FontSystem.setVisible("MyNAME",!1)}function A(){var e=Date.now()/1e3,t=e-o;o=e;let n=(t*=l)*r.getSpeed();if(M!==E.GAME_OVER&&M!==E.GAME_LOBBY&&M!==E.GAME_COUNTDOWN&&M!==E.HIGH_SCORE||(n=0),M===E.GAME_ENTRY){let e=r.getPosition();(e-=800*n)<=0-ScreenSize[0]/2&&(e=0-ScreenSize[0]/2,M=E.GAME_COUNTDOWN,setTimeout(function(){FontSystem.setVisible("CountDown",!1)},4e3),setTimeout(function(){FontSystem.setString("CountDown","Start"),r.run(),M=E.GAME_START,FontSystem.setVisible("score",!0),FontSystem.setVisible("HP",!0)},3e3),setTimeout(function(){FontSystem.setString("CountDown","1")},2e3),setTimeout(function(){FontSystem.setString("CountDown","2")},1e3),FontSystem.setVisible("CountDown",!0),FontSystem.setString("CountDown","3"),r.setIdle()),r.setPosition(e)}for(let t=0;t<d.length;t++)for(let e=0;e<d[t].length;e++)d[t][e][0]-=n*t*y,d[t][e][0]<-ScreenSize[0]/2*3&&(d[t][e][0]+=2*ScreenSize[0]);for(let e=0;e<c.length;e++)c[e][0]-=n*h,c[e][0]>100-ScreenSize[0]/2&&c[e][0]<270-ScreenSize[0]/2?r.damage()&&(p(e),0===--g)&&(r.die(),FontSystem.setVisible("Restart",!0),M=E.GAME_OVER,u,M=E.GAME_RESTART):c[e][0]<-ScreenSize[0]/2-128&&(p(e),u+=1);FontSystem.setString("score","Score : "+u);let i="";for(let e=0;e<g;e++)i+="@";FontSystem.setString("HP",i);e=t;gl.clearColor(s[0],s[1],s[2],.2),gl.clear(gl.COLOR_BUFFER_BIT);{let e=ScreenSize[0],t=ScreenSize[1],n=window.innerWidth*devicePixelRatio/e,i=window.innerHeight*devicePixelRatio/t,o=Math.min(n,i);1<o&&(o=1),e=10*Math.floor(e*o/10),t=10*Math.floor(t*o/10),canvas.width===e&&canvas.height===t||(canvas.width=e,canvas.height=t),r.resize(o),gl.viewport(0,0,canvas.width,canvas.height)}SpriteShader.bind(),SpriteShader.setTexture("0.png"),SpriteShader.setAttr([-512,-315],m),SpriteShader.draw();for(let t=0;t<8;t++){SpriteShader.setTexture(t+1+".png");for(let e=0;e<3;e++)SpriteShader.setAttr(d[t][e],m),SpriteShader.draw()}SpriteShader.setTexture("obstacle.png");for(let e=0;e<c.length;e++)SpriteShader.setAttr(c[e]),SpriteShader.draw();M===E.HIGH_SCORE&&(SpriteShader.setTexture("optionUI.png"),SpriteShader.setAttr([-256,-256]),SpriteShader.draw(),FontSystem.setVisible("Ranktxt",!0),FontSystem.setVisible("MyNAME",!0)),FontSystem.draw(),r.render(e,!1),requestAnimationFrame(A)}let F="";function t(e){M===E.GAME_START&&!0!==n[e.code]&&("Space"===e.code&&(e.preventDefault(),r.jump()),n[e.code]=!0)}function f(e){var t;M===E.HIGH_SCORE?(t=e.code,null!==(t=-1!==t.indexOf("Key")?t.replace("Key",""):null)&&(1===(F+=t).length||3===F.length?F+=" ":5===F.length&&(F.replace(/\s/gi,""),FontSystem.setVisible("Ranktxt",!1),FontSystem.setVisible("MyNAME",!1)),FontSystem.setString("MyNAME",F))):(M===E.GAME_RESTART?i():M===E.GAME_LOBBY&&(M=E.GAME_ENTRY,FontSystem.setVisible("Restart",!1)),n[e.code]=!1)}return{init:function(){canvas=document.getElementById("canvas");var e={alpha:!1};(gl=canvas.getContext("webgl",e)||canvas.getContext("experimental-webgl",e))?(document.addEventListener("keydown",t,!1),document.addEventListener("keyup",f,!1),(r=new SpineManager).init(),FontSystem.loadFont(),TextureUtil.loadTexture(function(){r.load(122331,43,function(){i()})}),FontSystem.setString("score","Score : "+u),FontSystem.setPosition("score",[300,-384]),FontSystem.setString("CountDown","3"),FontSystem.setPosition("CountDown",[0,30]),FontSystem.setString("Restart","Press Any Key To Start"),FontSystem.setPosition("Restart",[0,0]),FontSystem.setString("Ranktxt",""),FontSystem.setPosition("Ranktxt",[-30,140]),FontSystem.setString("MyNAME",""),FontSystem.setPosition("MyNAME",[-95,20])):alert("WebGL is unavailable.")},inputMobileDown:function(){t({code:"Space",preventDefault:()=>{}}),n.Space=!1},inputMobileUp:function(){f({code:"Space",preventDefault:()=>{}})}}}let main=new GameMain;main.init(),document.getElementById("mobile-button").addEventListener("touchstart",main.inputMobileDown),document.getElementById("mobile-button").addEventListener("touchend",main.inputMobileUp);
//# sourceMappingURL=main.min.js.map